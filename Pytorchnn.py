import torch
import torch.nn as nn
import torch.optim as optim
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
     

dt = load_iris()
     

X,y = dt.data, dt.target
     

X = torch.tensor(X, dtype=torch.float32)
y = torch.tensor(y, dtype=torch.long)
     

model = nn.Sequential(
    nn.Linear(4,10),
    nn.ReLU(),
    nn.Linear(10,3)
)
     

lossfn = nn.CrossEntropyLoss()
     

opt = optim.Adam(model.parameters(), lr=0.01)
     

for _ in range(200):
    opt.zero_grad()
    yp = model(X)
    loss = lossfn(yp, y)
    loss.backward()
    opt.step()
    print(loss.item())

yyp = model(X)
     

sfx = torch.softmax(yyp, axis=1)
     

torch.argmax(sfx, axis=1)
















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































